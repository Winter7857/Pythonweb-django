{% extends 'myapp/base.html' %}

{% block myheader %}
  <h1 class="h3">Edit Product: {{ p.title }}</h1>
{% endblock myheader %}

{% block content %}
<form method="POST" enctype="multipart/form-data">
  {% csrf_token %}

  <div class="row g-3">
    <div class="col-md-6">
      <label class="form-label">Title</label>
      <input type="text" name="title" class="form-control" value="{{ p.title }}" required>
    </div>
    <div class="col-md-6">
      <label class="form-label">Price</label>
      <input type="number" step="0.01" name="price" class="form-control" value="{{ p.price }}">
    </div>

    <div class="col-12">
      <label class="form-label">Description</label>
      <textarea name="description" class="form-control" rows="3">{{ p.description }}</textarea>
    </div>

    <div class="col-md-6">
      <label class="form-label">Quantity</label>
      <input type="number" name="quantity" class="form-control" value="{{ p.quantity }}">
    </div>
    <div class="col-md-6 d-flex align-items-center">
      <div class="form-check mt-4">
        <input class="form-check-input" type="checkbox" name="instock" id="instock" {% if p.instock %}checked{% endif %}>
        <label class="form-check-label" for="instock">In stock</label>
      </div>
    </div>

    

    <div class="col-md-6">
      <label class="form-label">Picture (image)</label>
      {% if p.picture %}
        <div class="mb-2"><img src="{{ p.picture.url }}" alt="{{ p.title }}" style="max-height:120px; border-radius:8px"></div>
      {% endif %}
      <input type="file" name="picture" accept="image/*" class="form-control mb-2">
      <div class="form-text">Upload a new image or paste a URL below.</div>
      <input type="url" name="image_url" placeholder="https://example.com/image.jpg" class="form-control" />
      <div class="form-text">If both are provided, the uploaded file is used.</div>
    </div>

    <div class="col-md-6">
      <label class="form-label">Spec file</label>
      {% if p.specfile %}
        <div class="mb-2"><a href="{{ p.specfile.url }}" download>Current file</a></div>
      {% endif %}
      <input type="file" name="specfile" class="form-control">
      <div class="form-text">Leave blank to keep current spec file.</div>
    </div>
  </div>

  <div class="mt-3">
    <button type="submit" class="btn btn-primary">Save changes</button>
    <a href="{% url 'editproduct-list' %}" class="btn btn-secondary">Back</a>
  </div>

  {% if message %}
    <div class="alert alert-success mt-3">{{ message }}</div>
  {% endif %}
</form>
{% endblock content %}
